/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PARAArchivePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// settings.ts
var DEFAULT_SETTINGS = {
  archiveConfigs: [
    {
      id: "default",
      name: "Default",
      rootPath: "",
      archivePath: "Archive",
      archiveMode: "date-based"
    }
  ],
  showConfirmation: true,
  linkUpdateMode: "always"
};

// settings-tab.ts
var import_obsidian = require("obsidian");
var PARAArchiveSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "PARA Archive Settings" });
    new import_obsidian.Setting(containerEl).setName("Show confirmation dialog").setDesc("Show a confirmation dialog before archiving files").addToggle((toggle) => toggle.setValue(this.plugin.settings.showConfirmation).onChange(async (value) => {
      this.plugin.settings.showConfirmation = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Link update mode").setDesc("How to handle internal links when archiving files").addDropdown((dropdown) => dropdown.addOption("always", "Always update links").addOption("ask", "Ask before updating").addOption("never", "Never update links").setValue(this.plugin.settings.linkUpdateMode).onChange(async (value) => {
      this.plugin.settings.linkUpdateMode = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Archive Configurations" });
    containerEl.createEl("p", { text: "Configure different archive setups for different parts of your vault (e.g., Personal, Work)" });
    new import_obsidian.Setting(containerEl).setName("Add new archive configuration").addButton((button) => button.setButtonText("Add").setCta().onClick(() => {
      this.addNewArchiveConfig();
    }));
    this.plugin.settings.archiveConfigs.forEach((config, index) => {
      this.displayArchiveConfig(containerEl, config, index);
    });
  }
  addNewArchiveConfig() {
    const newConfig = {
      id: Date.now().toString(),
      name: "New Configuration",
      rootPath: "",
      archivePath: "Archive",
      archiveMode: "date-based"
    };
    this.plugin.settings.archiveConfigs.push(newConfig);
    this.plugin.saveSettings();
    this.display();
  }
  displayArchiveConfig(containerEl, config, index) {
    const configDiv = containerEl.createDiv("archive-config");
    configDiv.createEl("h4", { text: `Configuration: ${config.name}` });
    new import_obsidian.Setting(configDiv).setName("Configuration name").setDesc("A friendly name for this archive configuration").addText((text) => text.setValue(config.name).onChange(async (value) => {
      config.name = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    new import_obsidian.Setting(configDiv).setName("Root path").setDesc('The root folder path this configuration applies to (e.g., "Personal", "Work"). Leave empty for vault root.').addText((text) => text.setValue(config.rootPath).onChange(async (value) => {
      config.rootPath = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(configDiv).setName("Archive path").setDesc("The folder where archived files will be moved (relative to root path)").addText((text) => text.setValue(config.archivePath).onChange(async (value) => {
      config.archivePath = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(configDiv).setName("Archive mode").setDesc("How files should be organized in the archive folder").addDropdown((dropdown) => dropdown.addOption("date-based", "Date-based (YYYY-MM folders)").addOption("path-mirror", "Mirror original path structure").setValue(config.archiveMode).onChange(async (value) => {
      config.archiveMode = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(configDiv).setName("Remove configuration").addButton((button) => button.setButtonText("Remove").setWarning().onClick(async () => {
      this.plugin.settings.archiveConfigs.splice(index, 1);
      await this.plugin.saveSettings();
      this.display();
    }));
    configDiv.createEl("hr");
  }
};

// archiver.ts
var import_obsidian2 = require("obsidian");
var Archiver = class {
  constructor(vault) {
    this.vault = vault;
  }
  /**
   * Determines which archive configuration applies to a given file path
   */
  findArchiveConfig(filePath, configs) {
    const sortedConfigs = configs.sort((a, b) => b.rootPath.length - a.rootPath.length);
    for (const config of sortedConfigs) {
      if (this.isFileInRoot(filePath, config.rootPath)) {
        return config;
      }
    }
    return null;
  }
  /**
   * Checks if a file is already in an archive folder
   */
  isFileInArchive(filePath, configs) {
    for (const config of configs) {
      const archiveFullPath = this.getArchiveFullPath(config);
      if (filePath.startsWith(archiveFullPath + "/") || filePath === archiveFullPath) {
        return true;
      }
    }
    return false;
  }
  /**
   * Generates the destination path for archiving a file
   */
  generateArchivePath(filePath, config) {
    const archiveBasePath = this.getArchiveFullPath(config);
    if (config.archiveMode === "date-based") {
      return this.generateDateBasedPath(filePath, archiveBasePath);
    } else {
      return this.generatePathMirrorPath(filePath, config, archiveBasePath);
    }
  }
  /**
   * Archives a file or folder to the appropriate location
   */
  async archiveFile(file, config) {
    const destinationPath = this.generateArchivePath(file.path, config);
    await this.ensureDirectoryExists(destinationPath);
    await this.vault.rename(file, destinationPath);
    return destinationPath;
  }
  isFileInRoot(filePath, rootPath) {
    if (!rootPath) {
      return true;
    }
    const normalizedRoot = (0, import_obsidian2.normalizePath)(rootPath);
    const normalizedFile = (0, import_obsidian2.normalizePath)(filePath);
    return normalizedFile.startsWith(normalizedRoot + "/") || normalizedFile === normalizedRoot;
  }
  getArchiveFullPath(config) {
    if (config.rootPath) {
      return (0, import_obsidian2.normalizePath)(`${config.rootPath}/${config.archivePath}`);
    }
    return (0, import_obsidian2.normalizePath)(config.archivePath);
  }
  generateDateBasedPath(filePath, archiveBasePath) {
    const now = new Date();
    const yearMonth = `${now.getFullYear()}-${(now.getMonth() + 1).toString().padStart(2, "0")}`;
    const fileName = filePath.split("/").pop() || "";
    return (0, import_obsidian2.normalizePath)(`${archiveBasePath}/${yearMonth}/${fileName}`);
  }
  generatePathMirrorPath(filePath, config, archiveBasePath) {
    let relativePath = filePath;
    if (config.rootPath) {
      const normalizedRoot = (0, import_obsidian2.normalizePath)(config.rootPath);
      if (filePath.startsWith(normalizedRoot + "/")) {
        relativePath = filePath.substring(normalizedRoot.length + 1);
      } else if (filePath === normalizedRoot) {
        relativePath = normalizedRoot.split("/").pop() || "";
      }
    }
    return (0, import_obsidian2.normalizePath)(`${archiveBasePath}/${relativePath}`);
  }
  async ensureDirectoryExists(filePath) {
    const directory = filePath.substring(0, filePath.lastIndexOf("/"));
    if (directory && !this.vault.getAbstractFileByPath(directory)) {
      const pathParts = directory.split("/");
      let currentPath = "";
      for (const part of pathParts) {
        currentPath = currentPath ? `${currentPath}/${part}` : part;
        const normalizedPath = (0, import_obsidian2.normalizePath)(currentPath);
        if (!this.vault.getAbstractFileByPath(normalizedPath)) {
          await this.vault.createFolder(normalizedPath);
        }
      }
    }
  }
};

// link-updater.ts
var LinkUpdater = class {
  constructor(app) {
    this.app = app;
    this.vault = app.vault;
    this.metadataCache = app.metadataCache;
  }
  /**
   * Finds all files that link to the given file
   */
  async findLinksToFile(targetFile) {
    const linkedFiles = [];
    const allFiles = this.vault.getMarkdownFiles();
    for (const file of allFiles) {
      const cache = this.metadataCache.getFileCache(file);
      if (!cache)
        continue;
      if (cache.links) {
        for (const link of cache.links) {
          const linkedFile = this.metadataCache.getFirstLinkpathDest(link.link, file.path);
          if (linkedFile && linkedFile.path === targetFile.path) {
            linkedFiles.push(file);
            break;
          }
        }
      }
      if (cache.embeds) {
        for (const embed of cache.embeds) {
          const linkedFile = this.metadataCache.getFirstLinkpathDest(embed.link, file.path);
          if (linkedFile && linkedFile.path === targetFile.path) {
            if (!linkedFiles.includes(file)) {
              linkedFiles.push(file);
            }
            break;
          }
        }
      }
    }
    return linkedFiles;
  }
  /**
   * Prepares link updates for all files that reference the moved file
   */
  async prepareLinkUpdates(oldPath, newPath) {
    const updates = [];
    const allFiles = this.vault.getMarkdownFiles();
    for (const file of allFiles) {
      const content = await this.vault.read(file);
      const newContent = this.updateLinksInContent(content, oldPath, newPath, file.path);
      if (content !== newContent) {
        const linkCount = this.countUpdatedLinks(content, newContent);
        updates.push({
          file,
          oldContent: content,
          newContent,
          linkCount
        });
      }
    }
    return updates;
  }
  /**
   * Applies all prepared link updates
   */
  async applyLinkUpdates(updates) {
    let success = 0;
    const failed = [];
    for (const update of updates) {
      try {
        await this.vault.modify(update.file, update.newContent);
        success++;
      } catch (error) {
        failed.push(update.file.path);
        console.error(`Failed to update links in ${update.file.path}:`, error);
      }
    }
    return { success, failed };
  }
  /**
   * Updates all links in content that point to the old path
   */
  updateLinksInContent(content, oldPath, newPath, currentFilePath) {
    var _a;
    let updatedContent = content;
    const oldFileName = ((_a = oldPath.split("/").pop()) == null ? void 0 : _a.replace(/\.[^/.]+$/, "")) || "";
    const newRelativePath = this.getRelativePath(currentFilePath, newPath);
    updatedContent = this.updateWikilinks(updatedContent, oldPath, newPath, oldFileName, newRelativePath, currentFilePath);
    updatedContent = this.updateMarkdownLinks(updatedContent, oldPath, newPath, currentFilePath);
    return updatedContent;
  }
  updateWikilinks(content, oldPath, newPath, oldFileName, newRelativePath, currentFilePath) {
    const wikilinkRegex = /\[\[([^\]|#^]+)([#^][^\]|]*)?\|?([^\]]*)?\]\]/g;
    return content.replace(wikilinkRegex, (match, linkPath, anchor, alias) => {
      const resolvedFile = this.metadataCache.getFirstLinkpathDest(linkPath.trim(), currentFilePath);
      if (resolvedFile && resolvedFile.path === oldPath) {
        const newLinkPath = newRelativePath.replace(/\.[^/.]+$/, "");
        const anchorPart = anchor || "";
        const aliasPart = alias ? `|${alias}` : "";
        return `[[${newLinkPath}${anchorPart}${aliasPart}]]`;
      }
      return match;
    });
  }
  updateMarkdownLinks(content, oldPath, newPath, currentFilePath) {
    const markdownLinkRegex = /(!?)\[([^\]]*)\]\(([^)]+)\)/g;
    return content.replace(markdownLinkRegex, (match, isEmbed, text, linkPath) => {
      const resolvedFile = this.metadataCache.getFirstLinkpathDest(linkPath.trim(), currentFilePath);
      if (resolvedFile && resolvedFile.path === oldPath) {
        const newRelativePath = this.getRelativePath(currentFilePath, newPath);
        return `${isEmbed}[${text}](${newRelativePath})`;
      }
      return match;
    });
  }
  getRelativePath(fromPath, toPath) {
    const fromParts = fromPath.split("/");
    const toParts = toPath.split("/");
    fromParts.pop();
    let commonLength = 0;
    for (let i = 0; i < Math.min(fromParts.length, toParts.length); i++) {
      if (fromParts[i] === toParts[i]) {
        commonLength++;
      } else {
        break;
      }
    }
    const upDirs = fromParts.length - commonLength;
    const relativeParts = [];
    for (let i = 0; i < upDirs; i++) {
      relativeParts.push("..");
    }
    relativeParts.push(...toParts.slice(commonLength));
    return relativeParts.join("/");
  }
  countUpdatedLinks(oldContent, newContent) {
    const oldLinks = (oldContent.match(/\[\[|\]\(/g) || []).length;
    const newLinks = (newContent.match(/\[\[|\]\(/g) || []).length;
    return Math.abs(newLinks - oldLinks);
  }
};

// confirmation-modal.ts
var import_obsidian3 = require("obsidian");
var ArchiveConfirmationModal = class extends import_obsidian3.Modal {
  constructor(app, file, config, destinationPath, linkUpdates, onConfirm, onCancel) {
    super(app);
    this.file = file;
    this.config = config;
    this.destinationPath = destinationPath;
    this.linkUpdates = linkUpdates;
    this.onConfirm = onConfirm;
    this.onCancel = onCancel;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Confirm Archive Operation" });
    const fileInfoDiv = contentEl.createDiv("archive-file-info");
    fileInfoDiv.createEl("h3", { text: "File to Archive" });
    const fileTypeIcon = this.file instanceof import_obsidian3.TFile ? "\u{1F4C4}" : "\u{1F4C1}";
    fileInfoDiv.createEl("p", {
      text: `${fileTypeIcon} ${this.file.name}`,
      cls: "archive-file-name"
    });
    fileInfoDiv.createEl("p", {
      text: `Current path: ${this.file.path}`,
      cls: "archive-current-path"
    });
    const archiveInfoDiv = contentEl.createDiv("archive-destination-info");
    archiveInfoDiv.createEl("h3", { text: "Archive Details" });
    archiveInfoDiv.createEl("p", { text: `Configuration: ${this.config.name}` });
    archiveInfoDiv.createEl("p", { text: `Archive mode: ${this.config.archiveMode}` });
    archiveInfoDiv.createEl("p", {
      text: `Destination: ${this.destinationPath}`,
      cls: "archive-destination-path"
    });
    if (this.linkUpdates.length > 0) {
      const linkInfoDiv = contentEl.createDiv("archive-link-info");
      linkInfoDiv.createEl("h3", { text: "Link Updates" });
      const totalLinks = this.linkUpdates.reduce((sum, update) => sum + update.linkCount, 0);
      linkInfoDiv.createEl("p", {
        text: `${this.linkUpdates.length} files with ${totalLinks} links will be updated`
      });
      const fileList = linkInfoDiv.createEl("ul", { cls: "archive-link-files" });
      const filesToShow = this.linkUpdates.slice(0, 5);
      filesToShow.forEach((update) => {
        const listItem = fileList.createEl("li");
        listItem.createEl("span", { text: update.file.name, cls: "file-name" });
        listItem.createEl("span", {
          text: ` (${update.linkCount} links)`,
          cls: "link-count"
        });
      });
      if (this.linkUpdates.length > 5) {
        fileList.createEl("li", {
          text: `... and ${this.linkUpdates.length - 5} more files`,
          cls: "more-files"
        });
      }
    } else {
      const noLinksDiv = contentEl.createDiv("archive-no-links");
      noLinksDiv.createEl("p", {
        text: "No links to this file were found.",
        cls: "no-links-message"
      });
    }
    const existingFile = this.app.vault.getAbstractFileByPath(this.destinationPath);
    if (existingFile) {
      const warningDiv = contentEl.createDiv("archive-warning");
      warningDiv.createEl("p", {
        text: "\u26A0\uFE0F A file or folder already exists at the destination path. It will be overwritten.",
        cls: "warning-message"
      });
    }
    const buttonDiv = contentEl.createDiv("archive-buttons");
    buttonDiv.createEl("button", { text: "Cancel" }).addEventListener("click", () => {
      this.onCancel();
      this.close();
    });
    const confirmButton = buttonDiv.createEl("button", {
      text: "Archive",
      cls: "mod-cta"
    });
    confirmButton.addEventListener("click", async () => {
      confirmButton.disabled = true;
      confirmButton.textContent = "Archiving...";
      try {
        await this.onConfirm();
        this.close();
      } catch (error) {
        confirmButton.disabled = false;
        confirmButton.textContent = "Archive";
        console.error("Archive operation failed:", error);
      }
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// main.ts
var PARAArchivePlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.archiver = new Archiver(this.app.vault);
    this.linkUpdater = new LinkUpdater(this.app);
    this.addSettingTab(new PARAArchiveSettingTab(this.app, this));
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        this.addArchiveMenuItem(menu, file);
      })
    );
    this.addCommand({
      id: "archive-current-file",
      name: "Archive current file",
      checkCallback: (checking) => {
        const activeFile = this.app.workspace.getActiveFile();
        if (activeFile) {
          if (!checking) {
            this.archiveFile(activeFile);
          }
          return true;
        }
        return false;
      }
    });
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  addArchiveMenuItem(menu, file) {
    if (this.archiver.isFileInArchive(file.path, this.settings.archiveConfigs)) {
      return;
    }
    const config = this.archiver.findArchiveConfig(file.path, this.settings.archiveConfigs);
    if (!config) {
      return;
    }
    menu.addItem((item) => {
      item.setTitle("PARA Archive").setIcon("archive").onClick(() => {
        this.archiveFile(file);
      });
    });
  }
  async archiveFile(file) {
    try {
      const config = this.archiver.findArchiveConfig(file.path, this.settings.archiveConfigs);
      if (!config) {
        new import_obsidian4.Notice("No archive configuration found for this file location");
        return;
      }
      if (this.archiver.isFileInArchive(file.path, this.settings.archiveConfigs)) {
        new import_obsidian4.Notice("File is already in an archive folder");
        return;
      }
      const destinationPath = this.archiver.generateArchivePath(file.path, config);
      let linkUpdates = [];
      if (this.settings.linkUpdateMode !== "never" && file instanceof import_obsidian4.TFile) {
        linkUpdates = await this.linkUpdater.prepareLinkUpdates(file.path, destinationPath);
      }
      if (this.settings.showConfirmation) {
        new ArchiveConfirmationModal(
          this.app,
          file,
          config,
          destinationPath,
          linkUpdates,
          async () => {
            await this.performArchive(file, config, destinationPath, linkUpdates);
          },
          () => {
          }
        ).open();
      } else {
        await this.performArchive(file, config, destinationPath, linkUpdates);
      }
    } catch (error) {
      console.error("Archive operation failed:", error);
      new import_obsidian4.Notice(`Archive failed: ${error.message}`);
    }
  }
  async performArchive(file, config, destinationPath, linkUpdates) {
    try {
      await this.archiver.archiveFile(file, config);
      if (this.settings.linkUpdateMode === "always" && linkUpdates.length > 0) {
        const result = await this.linkUpdater.applyLinkUpdates(linkUpdates);
        if (result.failed.length > 0) {
          new import_obsidian4.Notice(`File archived. Updated ${result.success} files, failed to update ${result.failed.length} files.`);
        } else {
          new import_obsidian4.Notice(`File archived successfully. Updated ${result.success} files with links.`);
        }
      } else if (this.settings.linkUpdateMode === "ask" && linkUpdates.length > 0) {
        new import_obsidian4.Notice(`File archived. ${linkUpdates.length} files contain links to this file. Use the command palette to update links if needed.`);
      } else {
        new import_obsidian4.Notice("File archived successfully");
      }
    } catch (error) {
      console.error("Archive operation failed:", error);
      new import_obsidian4.Notice(`Archive failed: ${error.message}`);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJzZXR0aW5ncy10YWIudHMiLCAiYXJjaGl2ZXIudHMiLCAibGluay11cGRhdGVyLnRzIiwgImNvbmZpcm1hdGlvbi1tb2RhbC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFRGaWxlLCBURm9sZGVyLCBOb3RpY2UsIE1lbnUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBQQVJBQXJjaGl2ZVNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBQQVJBQXJjaGl2ZVNldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzLXRhYic7XG5pbXBvcnQgeyBBcmNoaXZlciB9IGZyb20gJy4vYXJjaGl2ZXInO1xuaW1wb3J0IHsgTGlua1VwZGF0ZXIgfSBmcm9tICcuL2xpbmstdXBkYXRlcic7XG5pbXBvcnQgeyBBcmNoaXZlQ29uZmlybWF0aW9uTW9kYWwgfSBmcm9tICcuL2NvbmZpcm1hdGlvbi1tb2RhbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBBUkFBcmNoaXZlUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IFBBUkFBcmNoaXZlU2V0dGluZ3M7XG5cdHByaXZhdGUgYXJjaGl2ZXI6IEFyY2hpdmVyO1xuXHRwcml2YXRlIGxpbmtVcGRhdGVyOiBMaW5rVXBkYXRlcjtcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdC8vIEluaXRpYWxpemUgY29tcG9uZW50c1xuXHRcdHRoaXMuYXJjaGl2ZXIgPSBuZXcgQXJjaGl2ZXIodGhpcy5hcHAudmF1bHQpO1xuXHRcdHRoaXMubGlua1VwZGF0ZXIgPSBuZXcgTGlua1VwZGF0ZXIodGhpcy5hcHApO1xuXG5cdFx0Ly8gQWRkIHNldHRpbmdzIHRhYlxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUEFSQUFyY2hpdmVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0XHQvLyBSZWdpc3RlciBmaWxlIG1lbnUgZXZlbnQgZm9yIHJpZ2h0LWNsaWNrIGNvbnRleHQgbWVudVxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignZmlsZS1tZW51JywgKG1lbnU6IE1lbnUsIGZpbGU6IFRGaWxlIHwgVEZvbGRlcikgPT4ge1xuXHRcdFx0XHR0aGlzLmFkZEFyY2hpdmVNZW51SXRlbShtZW51LCBmaWxlKTtcblx0XHRcdH0pXG5cdFx0KTtcblxuXHRcdC8vIEFkZCBjb21tYW5kIGZvciBhcmNoaXZpbmcgY3VycmVudCBmaWxlXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnYXJjaGl2ZS1jdXJyZW50LWZpbGUnLFxuXHRcdFx0bmFtZTogJ0FyY2hpdmUgY3VycmVudCBmaWxlJyxcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0aWYgKGFjdGl2ZUZpbGUpIHtcblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmFyY2hpdmVGaWxlKGFjdGl2ZUZpbGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0XHQvLyBDbGVhbnVwIGlmIG5lZWRlZFxuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRwcml2YXRlIGFkZEFyY2hpdmVNZW51SXRlbShtZW51OiBNZW51LCBmaWxlOiBURmlsZSB8IFRGb2xkZXIpIHtcblx0XHQvLyBDaGVjayBpZiB0aGUgZmlsZSBpcyBhbHJlYWR5IGluIGFuIGFyY2hpdmUgZm9sZGVyXG5cdFx0aWYgKHRoaXMuYXJjaGl2ZXIuaXNGaWxlSW5BcmNoaXZlKGZpbGUucGF0aCwgdGhpcy5zZXR0aW5ncy5hcmNoaXZlQ29uZmlncykpIHtcblx0XHRcdHJldHVybjsgLy8gRG9uJ3Qgc2hvdyBhcmNoaXZlIG9wdGlvbiBmb3IgZmlsZXMgYWxyZWFkeSBpbiBhcmNoaXZlXG5cdFx0fVxuXG5cdFx0Ly8gRmluZCB0aGUgYXBwcm9wcmlhdGUgYXJjaGl2ZSBjb25maWd1cmF0aW9uXG5cdFx0Y29uc3QgY29uZmlnID0gdGhpcy5hcmNoaXZlci5maW5kQXJjaGl2ZUNvbmZpZyhmaWxlLnBhdGgsIHRoaXMuc2V0dGluZ3MuYXJjaGl2ZUNvbmZpZ3MpO1xuXHRcdGlmICghY29uZmlnKSB7XG5cdFx0XHRyZXR1cm47IC8vIE5vIGFwcGxpY2FibGUgY29uZmlndXJhdGlvbiBmb3VuZFxuXHRcdH1cblxuXHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0aXRlbS5zZXRUaXRsZSgnUEFSQSBBcmNoaXZlJylcblx0XHRcdFx0LnNldEljb24oJ2FyY2hpdmUnKVxuXHRcdFx0XHQub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcmNoaXZlRmlsZShmaWxlKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGFyY2hpdmVGaWxlKGZpbGU6IFRGaWxlIHwgVEZvbGRlcikge1xuXHRcdHRyeSB7XG5cdFx0XHQvLyBGaW5kIHRoZSBhcHByb3ByaWF0ZSBhcmNoaXZlIGNvbmZpZ3VyYXRpb25cblx0XHRcdGNvbnN0IGNvbmZpZyA9IHRoaXMuYXJjaGl2ZXIuZmluZEFyY2hpdmVDb25maWcoZmlsZS5wYXRoLCB0aGlzLnNldHRpbmdzLmFyY2hpdmVDb25maWdzKTtcblx0XHRcdGlmICghY29uZmlnKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ05vIGFyY2hpdmUgY29uZmlndXJhdGlvbiBmb3VuZCBmb3IgdGhpcyBmaWxlIGxvY2F0aW9uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgZmlsZSBpcyBhbHJlYWR5IGluIGFyY2hpdmVcblx0XHRcdGlmICh0aGlzLmFyY2hpdmVyLmlzRmlsZUluQXJjaGl2ZShmaWxlLnBhdGgsIHRoaXMuc2V0dGluZ3MuYXJjaGl2ZUNvbmZpZ3MpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0ZpbGUgaXMgYWxyZWFkeSBpbiBhbiBhcmNoaXZlIGZvbGRlcicpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdlbmVyYXRlIGRlc3RpbmF0aW9uIHBhdGhcblx0XHRcdGNvbnN0IGRlc3RpbmF0aW9uUGF0aCA9IHRoaXMuYXJjaGl2ZXIuZ2VuZXJhdGVBcmNoaXZlUGF0aChmaWxlLnBhdGgsIGNvbmZpZyk7XG5cblx0XHRcdC8vIFByZXBhcmUgbGluayB1cGRhdGVzIGlmIG5lZWRlZFxuXHRcdFx0bGV0IGxpbmtVcGRhdGVzID0gW107XG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5saW5rVXBkYXRlTW9kZSAhPT0gJ25ldmVyJyAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0bGlua1VwZGF0ZXMgPSBhd2FpdCB0aGlzLmxpbmtVcGRhdGVyLnByZXBhcmVMaW5rVXBkYXRlcyhmaWxlLnBhdGgsIGRlc3RpbmF0aW9uUGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNob3cgY29uZmlybWF0aW9uIGlmIGVuYWJsZWRcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnNob3dDb25maXJtYXRpb24pIHtcblx0XHRcdFx0bmV3IEFyY2hpdmVDb25maXJtYXRpb25Nb2RhbChcblx0XHRcdFx0XHR0aGlzLmFwcCxcblx0XHRcdFx0XHRmaWxlLFxuXHRcdFx0XHRcdGNvbmZpZyxcblx0XHRcdFx0XHRkZXN0aW5hdGlvblBhdGgsXG5cdFx0XHRcdFx0bGlua1VwZGF0ZXMsXG5cdFx0XHRcdFx0YXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wZXJmb3JtQXJjaGl2ZShmaWxlLCBjb25maWcsIGRlc3RpbmF0aW9uUGF0aCwgbGlua1VwZGF0ZXMpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0KCkgPT4ge1xuXHRcdFx0XHRcdFx0Ly8gVXNlciBjYW5jZWxsZWRcblx0XHRcdFx0XHR9XG5cdFx0XHRcdCkub3BlbigpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5wZXJmb3JtQXJjaGl2ZShmaWxlLCBjb25maWcsIGRlc3RpbmF0aW9uUGF0aCwgbGlua1VwZGF0ZXMpO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0FyY2hpdmUgb3BlcmF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBBcmNoaXZlIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWApO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgcGVyZm9ybUFyY2hpdmUoXG5cdFx0ZmlsZTogVEZpbGUgfCBURm9sZGVyLFxuXHRcdGNvbmZpZzogYW55LFxuXHRcdGRlc3RpbmF0aW9uUGF0aDogc3RyaW5nLFxuXHRcdGxpbmtVcGRhdGVzOiBhbnlbXVxuXHQpIHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gQXJjaGl2ZSB0aGUgZmlsZVxuXHRcdFx0YXdhaXQgdGhpcy5hcmNoaXZlci5hcmNoaXZlRmlsZShmaWxlLCBjb25maWcpO1xuXG5cdFx0XHQvLyBVcGRhdGUgbGlua3MgaWYgY29uZmlndXJlZCBhbmQgdGhlcmUgYXJlIHVwZGF0ZXNcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxpbmtVcGRhdGVNb2RlID09PSAnYWx3YXlzJyAmJiBsaW5rVXBkYXRlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubGlua1VwZGF0ZXIuYXBwbHlMaW5rVXBkYXRlcyhsaW5rVXBkYXRlcyk7XG5cblx0XHRcdFx0aWYgKHJlc3VsdC5mYWlsZWQubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgYXJjaGl2ZWQuIFVwZGF0ZWQgJHtyZXN1bHQuc3VjY2Vzc30gZmlsZXMsIGZhaWxlZCB0byB1cGRhdGUgJHtyZXN1bHQuZmFpbGVkLmxlbmd0aH0gZmlsZXMuYCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZShgRmlsZSBhcmNoaXZlZCBzdWNjZXNzZnVsbHkuIFVwZGF0ZWQgJHtyZXN1bHQuc3VjY2Vzc30gZmlsZXMgd2l0aCBsaW5rcy5gKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLmxpbmtVcGRhdGVNb2RlID09PSAnYXNrJyAmJiBsaW5rVXBkYXRlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vIFNob3cgYSBzZXBhcmF0ZSBtb2RhbCBvciBub3RpY2UgYXNraW5nIGFib3V0IGxpbmsgdXBkYXRlc1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFyY2hpdmVkLiAke2xpbmtVcGRhdGVzLmxlbmd0aH0gZmlsZXMgY29udGFpbiBsaW5rcyB0byB0aGlzIGZpbGUuIFVzZSB0aGUgY29tbWFuZCBwYWxldHRlIHRvIHVwZGF0ZSBsaW5rcyBpZiBuZWVkZWQuYCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdGaWxlIGFyY2hpdmVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fVxuXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ0FyY2hpdmUgb3BlcmF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBBcmNoaXZlIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWApO1xuXHRcdH1cblx0fVxufSIsICJleHBvcnQgdHlwZSBBcmNoaXZlTW9kZSA9ICdkYXRlLWJhc2VkJyB8ICdwYXRoLW1pcnJvcic7XG5cbmV4cG9ydCB0eXBlIExpbmtVcGRhdGVNb2RlID0gJ2Fsd2F5cycgfCAnYXNrJyB8ICduZXZlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXJjaGl2ZUNvbmZpZyB7XG5cdGlkOiBzdHJpbmc7XG5cdG5hbWU6IHN0cmluZztcblx0cm9vdFBhdGg6IHN0cmluZztcblx0YXJjaGl2ZVBhdGg6IHN0cmluZztcblx0YXJjaGl2ZU1vZGU6IEFyY2hpdmVNb2RlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBBUkFBcmNoaXZlU2V0dGluZ3Mge1xuXHRhcmNoaXZlQ29uZmlnczogQXJjaGl2ZUNvbmZpZ1tdO1xuXHRzaG93Q29uZmlybWF0aW9uOiBib29sZWFuO1xuXHRsaW5rVXBkYXRlTW9kZTogTGlua1VwZGF0ZU1vZGU7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQQVJBQXJjaGl2ZVNldHRpbmdzID0ge1xuXHRhcmNoaXZlQ29uZmlnczogW1xuXHRcdHtcblx0XHRcdGlkOiAnZGVmYXVsdCcsXG5cdFx0XHRuYW1lOiAnRGVmYXVsdCcsXG5cdFx0XHRyb290UGF0aDogJycsXG5cdFx0XHRhcmNoaXZlUGF0aDogJ0FyY2hpdmUnLFxuXHRcdFx0YXJjaGl2ZU1vZGU6ICdkYXRlLWJhc2VkJ1xuXHRcdH1cblx0XSxcblx0c2hvd0NvbmZpcm1hdGlvbjogdHJ1ZSxcblx0bGlua1VwZGF0ZU1vZGU6ICdhbHdheXMnXG59OyIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgUEFSQUFyY2hpdmVQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IEFyY2hpdmVDb25maWcsIEFyY2hpdmVNb2RlLCBMaW5rVXBkYXRlTW9kZSB9IGZyb20gJy4vc2V0dGluZ3MnO1xuXG5leHBvcnQgY2xhc3MgUEFSQUFyY2hpdmVTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogUEFSQUFyY2hpdmVQbHVnaW47XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUEFSQUFyY2hpdmVQbHVnaW4pIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnUEFSQSBBcmNoaXZlIFNldHRpbmdzJyB9KTtcblxuXHRcdC8vIEdsb2JhbCBzZXR0aW5nc1xuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1Nob3cgY29uZmlybWF0aW9uIGRpYWxvZycpXG5cdFx0XHQuc2V0RGVzYygnU2hvdyBhIGNvbmZpcm1hdGlvbiBkaWFsb2cgYmVmb3JlIGFyY2hpdmluZyBmaWxlcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb25maXJtYXRpb24pXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29uZmlybWF0aW9uID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0xpbmsgdXBkYXRlIG1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0hvdyB0byBoYW5kbGUgaW50ZXJuYWwgbGlua3Mgd2hlbiBhcmNoaXZpbmcgZmlsZXMnKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2Fsd2F5cycsICdBbHdheXMgdXBkYXRlIGxpbmtzJylcblx0XHRcdFx0LmFkZE9wdGlvbignYXNrJywgJ0FzayBiZWZvcmUgdXBkYXRpbmcnKVxuXHRcdFx0XHQuYWRkT3B0aW9uKCduZXZlcicsICdOZXZlciB1cGRhdGUgbGlua3MnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1VwZGF0ZU1vZGUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IExpbmtVcGRhdGVNb2RlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGlua1VwZGF0ZU1vZGUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0Ly8gQXJjaGl2ZSBjb25maWd1cmF0aW9uc1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0FyY2hpdmUgQ29uZmlndXJhdGlvbnMnIH0pO1xuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiAnQ29uZmlndXJlIGRpZmZlcmVudCBhcmNoaXZlIHNldHVwcyBmb3IgZGlmZmVyZW50IHBhcnRzIG9mIHlvdXIgdmF1bHQgKGUuZy4sIFBlcnNvbmFsLCBXb3JrKScgfSk7XG5cblx0XHQvLyBBZGQgbmV3IGNvbmZpZyBidXR0b25cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdBZGQgbmV3IGFyY2hpdmUgY29uZmlndXJhdGlvbicpXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ0FkZCcpXG5cdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHQub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hZGROZXdBcmNoaXZlQ29uZmlnKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdC8vIERpc3BsYXkgZXhpc3RpbmcgY29uZmlnc1xuXHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFyY2hpdmVDb25maWdzLmZvckVhY2goKGNvbmZpZywgaW5kZXgpID0+IHtcblx0XHRcdHRoaXMuZGlzcGxheUFyY2hpdmVDb25maWcoY29udGFpbmVyRWwsIGNvbmZpZywgaW5kZXgpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGROZXdBcmNoaXZlQ29uZmlnKCk6IHZvaWQge1xuXHRcdGNvbnN0IG5ld0NvbmZpZzogQXJjaGl2ZUNvbmZpZyA9IHtcblx0XHRcdGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG5cdFx0XHRuYW1lOiAnTmV3IENvbmZpZ3VyYXRpb24nLFxuXHRcdFx0cm9vdFBhdGg6ICcnLFxuXHRcdFx0YXJjaGl2ZVBhdGg6ICdBcmNoaXZlJyxcblx0XHRcdGFyY2hpdmVNb2RlOiAnZGF0ZS1iYXNlZCdcblx0XHR9O1xuXG5cdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYXJjaGl2ZUNvbmZpZ3MucHVzaChuZXdDb25maWcpO1xuXHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdHRoaXMuZGlzcGxheSgpOyAvLyBSZWZyZXNoIHRoZSBzZXR0aW5ncyB0YWJcblx0fVxuXG5cdHByaXZhdGUgZGlzcGxheUFyY2hpdmVDb25maWcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBjb25maWc6IEFyY2hpdmVDb25maWcsIGluZGV4OiBudW1iZXIpOiB2b2lkIHtcblx0XHRjb25zdCBjb25maWdEaXYgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ2FyY2hpdmUtY29uZmlnJyk7XG5cdFx0Y29uZmlnRGl2LmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogYENvbmZpZ3VyYXRpb246ICR7Y29uZmlnLm5hbWV9YCB9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbmZpZ0Rpdilcblx0XHRcdC5zZXROYW1lKCdDb25maWd1cmF0aW9uIG5hbWUnKVxuXHRcdFx0LnNldERlc2MoJ0EgZnJpZW5kbHkgbmFtZSBmb3IgdGhpcyBhcmNoaXZlIGNvbmZpZ3VyYXRpb24nKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRWYWx1ZShjb25maWcubmFtZSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdGNvbmZpZy5uYW1lID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbmZpZ0Rpdilcblx0XHRcdC5zZXROYW1lKCdSb290IHBhdGgnKVxuXHRcdFx0LnNldERlc2MoJ1RoZSByb290IGZvbGRlciBwYXRoIHRoaXMgY29uZmlndXJhdGlvbiBhcHBsaWVzIHRvIChlLmcuLCBcIlBlcnNvbmFsXCIsIFwiV29ya1wiKS4gTGVhdmUgZW1wdHkgZm9yIHZhdWx0IHJvb3QuJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0VmFsdWUoY29uZmlnLnJvb3RQYXRoKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0Y29uZmlnLnJvb3RQYXRoID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbmZpZ0Rpdilcblx0XHRcdC5zZXROYW1lKCdBcmNoaXZlIHBhdGgnKVxuXHRcdFx0LnNldERlc2MoJ1RoZSBmb2xkZXIgd2hlcmUgYXJjaGl2ZWQgZmlsZXMgd2lsbCBiZSBtb3ZlZCAocmVsYXRpdmUgdG8gcm9vdCBwYXRoKScpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFZhbHVlKGNvbmZpZy5hcmNoaXZlUGF0aClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdGNvbmZpZy5hcmNoaXZlUGF0aCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb25maWdEaXYpXG5cdFx0XHQuc2V0TmFtZSgnQXJjaGl2ZSBtb2RlJylcblx0XHRcdC5zZXREZXNjKCdIb3cgZmlsZXMgc2hvdWxkIGJlIG9yZ2FuaXplZCBpbiB0aGUgYXJjaGl2ZSBmb2xkZXInKVxuXHRcdFx0LmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG5cdFx0XHRcdC5hZGRPcHRpb24oJ2RhdGUtYmFzZWQnLCAnRGF0ZS1iYXNlZCAoWVlZWS1NTSBmb2xkZXJzKScpXG5cdFx0XHRcdC5hZGRPcHRpb24oJ3BhdGgtbWlycm9yJywgJ01pcnJvciBvcmlnaW5hbCBwYXRoIHN0cnVjdHVyZScpXG5cdFx0XHRcdC5zZXRWYWx1ZShjb25maWcuYXJjaGl2ZU1vZGUpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IEFyY2hpdmVNb2RlKSA9PiB7XG5cdFx0XHRcdFx0Y29uZmlnLmFyY2hpdmVNb2RlID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbmZpZ0Rpdilcblx0XHRcdC5zZXROYW1lKCdSZW1vdmUgY29uZmlndXJhdGlvbicpXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ1JlbW92ZScpXG5cdFx0XHRcdC5zZXRXYXJuaW5nKClcblx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFyY2hpdmVDb25maWdzLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdGNvbmZpZ0Rpdi5jcmVhdGVFbCgnaHInKTtcblx0fVxufSIsICJpbXBvcnQgeyBURmlsZSwgVEZvbGRlciwgVmF1bHQsIG5vcm1hbGl6ZVBhdGggfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBBcmNoaXZlQ29uZmlnLCBBcmNoaXZlTW9kZSB9IGZyb20gJy4vc2V0dGluZ3MnO1xuXG5leHBvcnQgY2xhc3MgQXJjaGl2ZXIge1xuXHRwcml2YXRlIHZhdWx0OiBWYXVsdDtcblxuXHRjb25zdHJ1Y3Rvcih2YXVsdDogVmF1bHQpIHtcblx0XHR0aGlzLnZhdWx0ID0gdmF1bHQ7XG5cdH1cblxuXHQvKipcblx0ICogRGV0ZXJtaW5lcyB3aGljaCBhcmNoaXZlIGNvbmZpZ3VyYXRpb24gYXBwbGllcyB0byBhIGdpdmVuIGZpbGUgcGF0aFxuXHQgKi9cblx0ZmluZEFyY2hpdmVDb25maWcoZmlsZVBhdGg6IHN0cmluZywgY29uZmlnczogQXJjaGl2ZUNvbmZpZ1tdKTogQXJjaGl2ZUNvbmZpZyB8IG51bGwge1xuXHRcdC8vIFNvcnQgY29uZmlncyBieSByb290IHBhdGggbGVuZ3RoIChsb25nZXN0IGZpcnN0KSB0byBtYXRjaCBtb3N0IHNwZWNpZmljIGZpcnN0XG5cdFx0Y29uc3Qgc29ydGVkQ29uZmlncyA9IGNvbmZpZ3Muc29ydCgoYSwgYikgPT4gYi5yb290UGF0aC5sZW5ndGggLSBhLnJvb3RQYXRoLmxlbmd0aCk7XG5cblx0XHRmb3IgKGNvbnN0IGNvbmZpZyBvZiBzb3J0ZWRDb25maWdzKSB7XG5cdFx0XHRpZiAodGhpcy5pc0ZpbGVJblJvb3QoZmlsZVBhdGgsIGNvbmZpZy5yb290UGF0aCkpIHtcblx0XHRcdFx0cmV0dXJuIGNvbmZpZztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDaGVja3MgaWYgYSBmaWxlIGlzIGFscmVhZHkgaW4gYW4gYXJjaGl2ZSBmb2xkZXJcblx0ICovXG5cdGlzRmlsZUluQXJjaGl2ZShmaWxlUGF0aDogc3RyaW5nLCBjb25maWdzOiBBcmNoaXZlQ29uZmlnW10pOiBib29sZWFuIHtcblx0XHRmb3IgKGNvbnN0IGNvbmZpZyBvZiBjb25maWdzKSB7XG5cdFx0XHRjb25zdCBhcmNoaXZlRnVsbFBhdGggPSB0aGlzLmdldEFyY2hpdmVGdWxsUGF0aChjb25maWcpO1xuXHRcdFx0aWYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgoYXJjaGl2ZUZ1bGxQYXRoICsgJy8nKSB8fCBmaWxlUGF0aCA9PT0gYXJjaGl2ZUZ1bGxQYXRoKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIHRoZSBkZXN0aW5hdGlvbiBwYXRoIGZvciBhcmNoaXZpbmcgYSBmaWxlXG5cdCAqL1xuXHRnZW5lcmF0ZUFyY2hpdmVQYXRoKGZpbGVQYXRoOiBzdHJpbmcsIGNvbmZpZzogQXJjaGl2ZUNvbmZpZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgYXJjaGl2ZUJhc2VQYXRoID0gdGhpcy5nZXRBcmNoaXZlRnVsbFBhdGgoY29uZmlnKTtcblxuXHRcdGlmIChjb25maWcuYXJjaGl2ZU1vZGUgPT09ICdkYXRlLWJhc2VkJykge1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2VuZXJhdGVEYXRlQmFzZWRQYXRoKGZpbGVQYXRoLCBhcmNoaXZlQmFzZVBhdGgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZW5lcmF0ZVBhdGhNaXJyb3JQYXRoKGZpbGVQYXRoLCBjb25maWcsIGFyY2hpdmVCYXNlUGF0aCk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEFyY2hpdmVzIGEgZmlsZSBvciBmb2xkZXIgdG8gdGhlIGFwcHJvcHJpYXRlIGxvY2F0aW9uXG5cdCAqL1xuXHRhc3luYyBhcmNoaXZlRmlsZShmaWxlOiBURmlsZSB8IFRGb2xkZXIsIGNvbmZpZzogQXJjaGl2ZUNvbmZpZyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgZGVzdGluYXRpb25QYXRoID0gdGhpcy5nZW5lcmF0ZUFyY2hpdmVQYXRoKGZpbGUucGF0aCwgY29uZmlnKTtcblxuXHRcdC8vIEVuc3VyZSB0aGUgZGVzdGluYXRpb24gZGlyZWN0b3J5IGV4aXN0c1xuXHRcdGF3YWl0IHRoaXMuZW5zdXJlRGlyZWN0b3J5RXhpc3RzKGRlc3RpbmF0aW9uUGF0aCk7XG5cblx0XHQvLyBNb3ZlIHRoZSBmaWxlXG5cdFx0YXdhaXQgdGhpcy52YXVsdC5yZW5hbWUoZmlsZSwgZGVzdGluYXRpb25QYXRoKTtcblxuXHRcdHJldHVybiBkZXN0aW5hdGlvblBhdGg7XG5cdH1cblxuXHRwcml2YXRlIGlzRmlsZUluUm9vdChmaWxlUGF0aDogc3RyaW5nLCByb290UGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG5cdFx0aWYgKCFyb290UGF0aCkge1xuXHRcdFx0cmV0dXJuIHRydWU7IC8vIEVtcHR5IHJvb3QgcGF0aCBtZWFucyB2YXVsdCByb290LCBtYXRjaGVzIGV2ZXJ5dGhpbmdcblx0XHR9XG5cblx0XHRjb25zdCBub3JtYWxpemVkUm9vdCA9IG5vcm1hbGl6ZVBhdGgocm9vdFBhdGgpO1xuXHRcdGNvbnN0IG5vcm1hbGl6ZWRGaWxlID0gbm9ybWFsaXplUGF0aChmaWxlUGF0aCk7XG5cblx0XHRyZXR1cm4gbm9ybWFsaXplZEZpbGUuc3RhcnRzV2l0aChub3JtYWxpemVkUm9vdCArICcvJykgfHwgbm9ybWFsaXplZEZpbGUgPT09IG5vcm1hbGl6ZWRSb290O1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBcmNoaXZlRnVsbFBhdGgoY29uZmlnOiBBcmNoaXZlQ29uZmlnKTogc3RyaW5nIHtcblx0XHRpZiAoY29uZmlnLnJvb3RQYXRoKSB7XG5cdFx0XHRyZXR1cm4gbm9ybWFsaXplUGF0aChgJHtjb25maWcucm9vdFBhdGh9LyR7Y29uZmlnLmFyY2hpdmVQYXRofWApO1xuXHRcdH1cblx0XHRyZXR1cm4gbm9ybWFsaXplUGF0aChjb25maWcuYXJjaGl2ZVBhdGgpO1xuXHR9XG5cblx0cHJpdmF0ZSBnZW5lcmF0ZURhdGVCYXNlZFBhdGgoZmlsZVBhdGg6IHN0cmluZywgYXJjaGl2ZUJhc2VQYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cdFx0Y29uc3QgeWVhck1vbnRoID0gYCR7bm93LmdldEZ1bGxZZWFyKCl9LSR7KG5vdy5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWA7XG5cdFx0Y29uc3QgZmlsZU5hbWUgPSBmaWxlUGF0aC5zcGxpdCgnLycpLnBvcCgpIHx8ICcnO1xuXG5cdFx0cmV0dXJuIG5vcm1hbGl6ZVBhdGgoYCR7YXJjaGl2ZUJhc2VQYXRofS8ke3llYXJNb250aH0vJHtmaWxlTmFtZX1gKTtcblx0fVxuXG5cdHByaXZhdGUgZ2VuZXJhdGVQYXRoTWlycm9yUGF0aChmaWxlUGF0aDogc3RyaW5nLCBjb25maWc6IEFyY2hpdmVDb25maWcsIGFyY2hpdmVCYXNlUGF0aDogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRsZXQgcmVsYXRpdmVQYXRoID0gZmlsZVBhdGg7XG5cblx0XHQvLyBSZW1vdmUgdGhlIHJvb3QgcGF0aCBmcm9tIHRoZSBmaWxlIHBhdGggdG8gZ2V0IHJlbGF0aXZlIHBhdGhcblx0XHRpZiAoY29uZmlnLnJvb3RQYXRoKSB7XG5cdFx0XHRjb25zdCBub3JtYWxpemVkUm9vdCA9IG5vcm1hbGl6ZVBhdGgoY29uZmlnLnJvb3RQYXRoKTtcblx0XHRcdGlmIChmaWxlUGF0aC5zdGFydHNXaXRoKG5vcm1hbGl6ZWRSb290ICsgJy8nKSkge1xuXHRcdFx0XHRyZWxhdGl2ZVBhdGggPSBmaWxlUGF0aC5zdWJzdHJpbmcobm9ybWFsaXplZFJvb3QubGVuZ3RoICsgMSk7XG5cdFx0XHR9IGVsc2UgaWYgKGZpbGVQYXRoID09PSBub3JtYWxpemVkUm9vdCkge1xuXHRcdFx0XHQvLyBJZiBhcmNoaXZpbmcgdGhlIHJvb3QgZm9sZGVyIGl0c2VsZiwgdXNlIGl0cyBuYW1lXG5cdFx0XHRcdHJlbGF0aXZlUGF0aCA9IG5vcm1hbGl6ZWRSb290LnNwbGl0KCcvJykucG9wKCkgfHwgJyc7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5vcm1hbGl6ZVBhdGgoYCR7YXJjaGl2ZUJhc2VQYXRofS8ke3JlbGF0aXZlUGF0aH1gKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgZW5zdXJlRGlyZWN0b3J5RXhpc3RzKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBkaXJlY3RvcnkgPSBmaWxlUGF0aC5zdWJzdHJpbmcoMCwgZmlsZVBhdGgubGFzdEluZGV4T2YoJy8nKSk7XG5cblx0XHRpZiAoZGlyZWN0b3J5ICYmICF0aGlzLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkaXJlY3RvcnkpKSB7XG5cdFx0XHQvLyBDcmVhdGUgZGlyZWN0b3J5IHJlY3Vyc2l2ZWx5XG5cdFx0XHRjb25zdCBwYXRoUGFydHMgPSBkaXJlY3Rvcnkuc3BsaXQoJy8nKTtcblx0XHRcdGxldCBjdXJyZW50UGF0aCA9ICcnO1xuXG5cdFx0XHRmb3IgKGNvbnN0IHBhcnQgb2YgcGF0aFBhcnRzKSB7XG5cdFx0XHRcdGN1cnJlbnRQYXRoID0gY3VycmVudFBhdGggPyBgJHtjdXJyZW50UGF0aH0vJHtwYXJ0fWAgOiBwYXJ0O1xuXHRcdFx0XHRjb25zdCBub3JtYWxpemVkUGF0aCA9IG5vcm1hbGl6ZVBhdGgoY3VycmVudFBhdGgpO1xuXG5cdFx0XHRcdGlmICghdGhpcy52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm9ybWFsaXplZFBhdGgpKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy52YXVsdC5jcmVhdGVGb2xkZXIobm9ybWFsaXplZFBhdGgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgVEZpbGUsIE1ldGFkYXRhQ2FjaGUsIFZhdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIExpbmtVcGRhdGUge1xuXHRmaWxlOiBURmlsZTtcblx0b2xkQ29udGVudDogc3RyaW5nO1xuXHRuZXdDb250ZW50OiBzdHJpbmc7XG5cdGxpbmtDb3VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgTGlua1VwZGF0ZXIge1xuXHRwcml2YXRlIGFwcDogQXBwO1xuXHRwcml2YXRlIHZhdWx0OiBWYXVsdDtcblx0cHJpdmF0ZSBtZXRhZGF0YUNhY2hlOiBNZXRhZGF0YUNhY2hlO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwKSB7XG5cdFx0dGhpcy5hcHAgPSBhcHA7XG5cdFx0dGhpcy52YXVsdCA9IGFwcC52YXVsdDtcblx0XHR0aGlzLm1ldGFkYXRhQ2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBGaW5kcyBhbGwgZmlsZXMgdGhhdCBsaW5rIHRvIHRoZSBnaXZlbiBmaWxlXG5cdCAqL1xuXHRhc3luYyBmaW5kTGlua3NUb0ZpbGUodGFyZ2V0RmlsZTogVEZpbGUpOiBQcm9taXNlPFRGaWxlW10+IHtcblx0XHRjb25zdCBsaW5rZWRGaWxlczogVEZpbGVbXSA9IFtdO1xuXHRcdGNvbnN0IGFsbEZpbGVzID0gdGhpcy52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0XHRmb3IgKGNvbnN0IGZpbGUgb2YgYWxsRmlsZXMpIHtcblx0XHRcdGNvbnN0IGNhY2hlID0gdGhpcy5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRcdGlmICghY2FjaGUpIGNvbnRpbnVlO1xuXG5cdFx0XHQvLyBDaGVjayBsaW5rc1xuXHRcdFx0aWYgKGNhY2hlLmxpbmtzKSB7XG5cdFx0XHRcdGZvciAoY29uc3QgbGluayBvZiBjYWNoZS5saW5rcykge1xuXHRcdFx0XHRcdGNvbnN0IGxpbmtlZEZpbGUgPSB0aGlzLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGluay5saW5rLCBmaWxlLnBhdGgpO1xuXHRcdFx0XHRcdGlmIChsaW5rZWRGaWxlICYmIGxpbmtlZEZpbGUucGF0aCA9PT0gdGFyZ2V0RmlsZS5wYXRoKSB7XG5cdFx0XHRcdFx0XHRsaW5rZWRGaWxlcy5wdXNoKGZpbGUpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGVtYmVkc1xuXHRcdFx0aWYgKGNhY2hlLmVtYmVkcykge1xuXHRcdFx0XHRmb3IgKGNvbnN0IGVtYmVkIG9mIGNhY2hlLmVtYmVkcykge1xuXHRcdFx0XHRcdGNvbnN0IGxpbmtlZEZpbGUgPSB0aGlzLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoZW1iZWQubGluaywgZmlsZS5wYXRoKTtcblx0XHRcdFx0XHRpZiAobGlua2VkRmlsZSAmJiBsaW5rZWRGaWxlLnBhdGggPT09IHRhcmdldEZpbGUucGF0aCkge1xuXHRcdFx0XHRcdFx0aWYgKCFsaW5rZWRGaWxlcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdFx0XHRcdFx0XHRsaW5rZWRGaWxlcy5wdXNoKGZpbGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGxpbmtlZEZpbGVzO1xuXHR9XG5cblx0LyoqXG5cdCAqIFByZXBhcmVzIGxpbmsgdXBkYXRlcyBmb3IgYWxsIGZpbGVzIHRoYXQgcmVmZXJlbmNlIHRoZSBtb3ZlZCBmaWxlXG5cdCAqL1xuXHRhc3luYyBwcmVwYXJlTGlua1VwZGF0ZXMob2xkUGF0aDogc3RyaW5nLCBuZXdQYXRoOiBzdHJpbmcpOiBQcm9taXNlPExpbmtVcGRhdGVbXT4ge1xuXHRcdGNvbnN0IHVwZGF0ZXM6IExpbmtVcGRhdGVbXSA9IFtdO1xuXHRcdGNvbnN0IGFsbEZpbGVzID0gdGhpcy52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0XHRmb3IgKGNvbnN0IGZpbGUgb2YgYWxsRmlsZXMpIHtcblx0XHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRjb25zdCBuZXdDb250ZW50ID0gdGhpcy51cGRhdGVMaW5rc0luQ29udGVudChjb250ZW50LCBvbGRQYXRoLCBuZXdQYXRoLCBmaWxlLnBhdGgpO1xuXG5cdFx0XHRpZiAoY29udGVudCAhPT0gbmV3Q29udGVudCkge1xuXHRcdFx0XHRjb25zdCBsaW5rQ291bnQgPSB0aGlzLmNvdW50VXBkYXRlZExpbmtzKGNvbnRlbnQsIG5ld0NvbnRlbnQpO1xuXHRcdFx0XHR1cGRhdGVzLnB1c2goe1xuXHRcdFx0XHRcdGZpbGUsXG5cdFx0XHRcdFx0b2xkQ29udGVudDogY29udGVudCxcblx0XHRcdFx0XHRuZXdDb250ZW50LFxuXHRcdFx0XHRcdGxpbmtDb3VudFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdXBkYXRlcztcblx0fVxuXG5cdC8qKlxuXHQgKiBBcHBsaWVzIGFsbCBwcmVwYXJlZCBsaW5rIHVwZGF0ZXNcblx0ICovXG5cdGFzeW5jIGFwcGx5TGlua1VwZGF0ZXModXBkYXRlczogTGlua1VwZGF0ZVtdKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IG51bWJlcjsgZmFpbGVkOiBzdHJpbmdbXSB9PiB7XG5cdFx0bGV0IHN1Y2Nlc3MgPSAwO1xuXHRcdGNvbnN0IGZhaWxlZDogc3RyaW5nW10gPSBbXTtcblxuXHRcdGZvciAoY29uc3QgdXBkYXRlIG9mIHVwZGF0ZXMpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMudmF1bHQubW9kaWZ5KHVwZGF0ZS5maWxlLCB1cGRhdGUubmV3Q29udGVudCk7XG5cdFx0XHRcdHN1Y2Nlc3MrKztcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGZhaWxlZC5wdXNoKHVwZGF0ZS5maWxlLnBhdGgpO1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gdXBkYXRlIGxpbmtzIGluICR7dXBkYXRlLmZpbGUucGF0aH06YCwgZXJyb3IpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7IHN1Y2Nlc3MsIGZhaWxlZCB9O1xuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZXMgYWxsIGxpbmtzIGluIGNvbnRlbnQgdGhhdCBwb2ludCB0byB0aGUgb2xkIHBhdGhcblx0ICovXG5cdHByaXZhdGUgdXBkYXRlTGlua3NJbkNvbnRlbnQoY29udGVudDogc3RyaW5nLCBvbGRQYXRoOiBzdHJpbmcsIG5ld1BhdGg6IHN0cmluZywgY3VycmVudEZpbGVQYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGxldCB1cGRhdGVkQ29udGVudCA9IGNvbnRlbnQ7XG5cblx0XHQvLyBHZXQgdGhlIGZpbGUgbmFtZSB3aXRob3V0IGV4dGVuc2lvbiBmb3IgbWF0Y2hpbmdcblx0XHRjb25zdCBvbGRGaWxlTmFtZSA9IG9sZFBhdGguc3BsaXQoJy8nKS5wb3AoKT8ucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKSB8fCAnJztcblx0XHRjb25zdCBuZXdSZWxhdGl2ZVBhdGggPSB0aGlzLmdldFJlbGF0aXZlUGF0aChjdXJyZW50RmlsZVBhdGgsIG5ld1BhdGgpO1xuXG5cdFx0Ly8gVXBkYXRlIHdpa2lsaW5rc1xuXHRcdHVwZGF0ZWRDb250ZW50ID0gdGhpcy51cGRhdGVXaWtpbGlua3ModXBkYXRlZENvbnRlbnQsIG9sZFBhdGgsIG5ld1BhdGgsIG9sZEZpbGVOYW1lLCBuZXdSZWxhdGl2ZVBhdGgsIGN1cnJlbnRGaWxlUGF0aCk7XG5cblx0XHQvLyBVcGRhdGUgbWFya2Rvd24gbGlua3Ncblx0XHR1cGRhdGVkQ29udGVudCA9IHRoaXMudXBkYXRlTWFya2Rvd25MaW5rcyh1cGRhdGVkQ29udGVudCwgb2xkUGF0aCwgbmV3UGF0aCwgY3VycmVudEZpbGVQYXRoKTtcblxuXHRcdHJldHVybiB1cGRhdGVkQ29udGVudDtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlV2lraWxpbmtzKGNvbnRlbnQ6IHN0cmluZywgb2xkUGF0aDogc3RyaW5nLCBuZXdQYXRoOiBzdHJpbmcsIG9sZEZpbGVOYW1lOiBzdHJpbmcsIG5ld1JlbGF0aXZlUGF0aDogc3RyaW5nLCBjdXJyZW50RmlsZVBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gUmVnZXggdG8gbWF0Y2ggd2lraWxpbmtzOiBbW2xpbmt8YWxpYXNdXSBvciBbW2xpbmsjaGVhZGVyXV0gb3IgW1tsaW5rXmJsb2NrXV0gb3IgW1tsaW5rXV1cblx0XHRjb25zdCB3aWtpbGlua1JlZ2V4ID0gL1xcW1xcWyhbXlxcXXwjXl0rKShbI15dW15cXF18XSopP1xcfD8oW15cXF1dKik/XFxdXFxdL2c7XG5cblx0XHRyZXR1cm4gY29udGVudC5yZXBsYWNlKHdpa2lsaW5rUmVnZXgsIChtYXRjaCwgbGlua1BhdGgsIGFuY2hvciwgYWxpYXMpID0+IHtcblx0XHRcdGNvbnN0IHJlc29sdmVkRmlsZSA9IHRoaXMubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rUGF0aC50cmltKCksIGN1cnJlbnRGaWxlUGF0aCk7XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoaXMgbGluayBwb2ludHMgdG8gb3VyIG1vdmVkIGZpbGVcblx0XHRcdGlmIChyZXNvbHZlZEZpbGUgJiYgcmVzb2x2ZWRGaWxlLnBhdGggPT09IG9sZFBhdGgpIHtcblx0XHRcdFx0Ly8gVXNlIHJlbGF0aXZlIHBhdGggd2l0aG91dCBleHRlbnNpb24gZm9yIHdpa2lsaW5rc1xuXHRcdFx0XHRjb25zdCBuZXdMaW5rUGF0aCA9IG5ld1JlbGF0aXZlUGF0aC5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpO1xuXHRcdFx0XHRjb25zdCBhbmNob3JQYXJ0ID0gYW5jaG9yIHx8ICcnO1xuXHRcdFx0XHRjb25zdCBhbGlhc1BhcnQgPSBhbGlhcyA/IGB8JHthbGlhc31gIDogJyc7XG5cblx0XHRcdFx0cmV0dXJuIGBbWyR7bmV3TGlua1BhdGh9JHthbmNob3JQYXJ0fSR7YWxpYXNQYXJ0fV1dYDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG1hdGNoO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVNYXJrZG93bkxpbmtzKGNvbnRlbnQ6IHN0cmluZywgb2xkUGF0aDogc3RyaW5nLCBuZXdQYXRoOiBzdHJpbmcsIGN1cnJlbnRGaWxlUGF0aDogc3RyaW5nKTogc3RyaW5nIHtcblx0XHQvLyBSZWdleCB0byBtYXRjaCBtYXJrZG93biBsaW5rczogW3RleHRdKHBhdGgpIG9yICFbYWx0XShwYXRoKVxuXHRcdGNvbnN0IG1hcmtkb3duTGlua1JlZ2V4ID0gLyghPylcXFsoW15cXF1dKilcXF1cXCgoW14pXSspXFwpL2c7XG5cblx0XHRyZXR1cm4gY29udGVudC5yZXBsYWNlKG1hcmtkb3duTGlua1JlZ2V4LCAobWF0Y2gsIGlzRW1iZWQsIHRleHQsIGxpbmtQYXRoKSA9PiB7XG5cdFx0XHQvLyBSZXNvbHZlIHRoZSBsaW5rIHRvIHNlZSBpZiBpdCBwb2ludHMgdG8gb3VyIG1vdmVkIGZpbGVcblx0XHRcdGNvbnN0IHJlc29sdmVkRmlsZSA9IHRoaXMubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rUGF0aC50cmltKCksIGN1cnJlbnRGaWxlUGF0aCk7XG5cblx0XHRcdGlmIChyZXNvbHZlZEZpbGUgJiYgcmVzb2x2ZWRGaWxlLnBhdGggPT09IG9sZFBhdGgpIHtcblx0XHRcdFx0Y29uc3QgbmV3UmVsYXRpdmVQYXRoID0gdGhpcy5nZXRSZWxhdGl2ZVBhdGgoY3VycmVudEZpbGVQYXRoLCBuZXdQYXRoKTtcblx0XHRcdFx0cmV0dXJuIGAke2lzRW1iZWR9WyR7dGV4dH1dKCR7bmV3UmVsYXRpdmVQYXRofSlgO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gbWF0Y2g7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGdldFJlbGF0aXZlUGF0aChmcm9tUGF0aDogc3RyaW5nLCB0b1BhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gU2ltcGxlIHJlbGF0aXZlIHBhdGggY2FsY3VsYXRpb25cblx0XHRjb25zdCBmcm9tUGFydHMgPSBmcm9tUGF0aC5zcGxpdCgnLycpO1xuXHRcdGNvbnN0IHRvUGFydHMgPSB0b1BhdGguc3BsaXQoJy8nKTtcblxuXHRcdC8vIFJlbW92ZSBmaWxlbmFtZSBmcm9tIGZyb21QYXRoXG5cdFx0ZnJvbVBhcnRzLnBvcCgpO1xuXG5cdFx0Ly8gRmluZCBjb21tb24gcGF0aFxuXHRcdGxldCBjb21tb25MZW5ndGggPSAwO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5taW4oZnJvbVBhcnRzLmxlbmd0aCwgdG9QYXJ0cy5sZW5ndGgpOyBpKyspIHtcblx0XHRcdGlmIChmcm9tUGFydHNbaV0gPT09IHRvUGFydHNbaV0pIHtcblx0XHRcdFx0Y29tbW9uTGVuZ3RoKys7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDYWxjdWxhdGUgcmVsYXRpdmUgcGF0aFxuXHRcdGNvbnN0IHVwRGlycyA9IGZyb21QYXJ0cy5sZW5ndGggLSBjb21tb25MZW5ndGg7XG5cdFx0Y29uc3QgcmVsYXRpdmVQYXJ0cyA9IFtdO1xuXG5cdFx0Ly8gQWRkIC4uLyBmb3IgZWFjaCBkaXJlY3Rvcnkgd2UgbmVlZCB0byBnbyB1cFxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdXBEaXJzOyBpKyspIHtcblx0XHRcdHJlbGF0aXZlUGFydHMucHVzaCgnLi4nKTtcblx0XHR9XG5cblx0XHQvLyBBZGQgdGhlIHJlbWFpbmluZyBwYXRoIHRvIHRoZSB0YXJnZXRcblx0XHRyZWxhdGl2ZVBhcnRzLnB1c2goLi4udG9QYXJ0cy5zbGljZShjb21tb25MZW5ndGgpKTtcblxuXHRcdHJldHVybiByZWxhdGl2ZVBhcnRzLmpvaW4oJy8nKTtcblx0fVxuXG5cdHByaXZhdGUgY291bnRVcGRhdGVkTGlua3Mob2xkQ29udGVudDogc3RyaW5nLCBuZXdDb250ZW50OiBzdHJpbmcpOiBudW1iZXIge1xuXHRcdC8vIFNpbXBsZSBhcHByb2FjaDogY291bnQgdGhlIG51bWJlciBvZiBbWyBvciBdKCB0aGF0IGNoYW5nZWRcblx0XHRjb25zdCBvbGRMaW5rcyA9IChvbGRDb250ZW50Lm1hdGNoKC9cXFtcXFt8XFxdXFwoL2cpIHx8IFtdKS5sZW5ndGg7XG5cdFx0Y29uc3QgbmV3TGlua3MgPSAobmV3Q29udGVudC5tYXRjaCgvXFxbXFxbfFxcXVxcKC9nKSB8fCBbXSkubGVuZ3RoO1xuXG5cdFx0Ly8gVGhpcyBpcyBhIHJvdWdoIGVzdGltYXRlIC0gdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbiBjb3VsZCBiZSBtb3JlIHByZWNpc2Vcblx0XHRyZXR1cm4gTWF0aC5hYnMobmV3TGlua3MgLSBvbGRMaW5rcyk7XG5cdH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBBcmNoaXZlQ29uZmlnIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBMaW5rVXBkYXRlIH0gZnJvbSAnLi9saW5rLXVwZGF0ZXInO1xuXG5leHBvcnQgY2xhc3MgQXJjaGl2ZUNvbmZpcm1hdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRwcml2YXRlIGZpbGU6IFRGaWxlIHwgVEZvbGRlcjtcblx0cHJpdmF0ZSBjb25maWc6IEFyY2hpdmVDb25maWc7XG5cdHByaXZhdGUgZGVzdGluYXRpb25QYXRoOiBzdHJpbmc7XG5cdHByaXZhdGUgbGlua1VwZGF0ZXM6IExpbmtVcGRhdGVbXTtcblx0cHJpdmF0ZSBvbkNvbmZpcm06ICgpID0+IFByb21pc2U8dm9pZD47XG5cdHByaXZhdGUgb25DYW5jZWw6ICgpID0+IHZvaWQ7XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0YXBwOiBBcHAsXG5cdFx0ZmlsZTogVEZpbGUgfCBURm9sZGVyLFxuXHRcdGNvbmZpZzogQXJjaGl2ZUNvbmZpZyxcblx0XHRkZXN0aW5hdGlvblBhdGg6IHN0cmluZyxcblx0XHRsaW5rVXBkYXRlczogTGlua1VwZGF0ZVtdLFxuXHRcdG9uQ29uZmlybTogKCkgPT4gUHJvbWlzZTx2b2lkPixcblx0XHRvbkNhbmNlbDogKCkgPT4gdm9pZFxuXHQpIHtcblx0XHRzdXBlcihhcHApO1xuXHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdFx0dGhpcy5kZXN0aW5hdGlvblBhdGggPSBkZXN0aW5hdGlvblBhdGg7XG5cdFx0dGhpcy5saW5rVXBkYXRlcyA9IGxpbmtVcGRhdGVzO1xuXHRcdHRoaXMub25Db25maXJtID0gb25Db25maXJtO1xuXHRcdHRoaXMub25DYW5jZWwgPSBvbkNhbmNlbDtcblx0fVxuXG5cdG9uT3BlbigpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdDb25maXJtIEFyY2hpdmUgT3BlcmF0aW9uJyB9KTtcblxuXHRcdC8vIEZpbGUgaW5mb3JtYXRpb25cblx0XHRjb25zdCBmaWxlSW5mb0RpdiA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ2FyY2hpdmUtZmlsZS1pbmZvJyk7XG5cdFx0ZmlsZUluZm9EaXYuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnRmlsZSB0byBBcmNoaXZlJyB9KTtcblxuXHRcdGNvbnN0IGZpbGVUeXBlSWNvbiA9IHRoaXMuZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gJ1x1RDgzRFx1RENDNCcgOiAnXHVEODNEXHVEQ0MxJztcblx0XHRmaWxlSW5mb0Rpdi5jcmVhdGVFbCgncCcsIHtcblx0XHRcdHRleHQ6IGAke2ZpbGVUeXBlSWNvbn0gJHt0aGlzLmZpbGUubmFtZX1gLFxuXHRcdFx0Y2xzOiAnYXJjaGl2ZS1maWxlLW5hbWUnXG5cdFx0fSk7XG5cblx0XHRmaWxlSW5mb0Rpdi5jcmVhdGVFbCgncCcsIHtcblx0XHRcdHRleHQ6IGBDdXJyZW50IHBhdGg6ICR7dGhpcy5maWxlLnBhdGh9YCxcblx0XHRcdGNsczogJ2FyY2hpdmUtY3VycmVudC1wYXRoJ1xuXHRcdH0pO1xuXG5cdFx0Ly8gQXJjaGl2ZSBpbmZvcm1hdGlvblxuXHRcdGNvbnN0IGFyY2hpdmVJbmZvRGl2ID0gY29udGVudEVsLmNyZWF0ZURpdignYXJjaGl2ZS1kZXN0aW5hdGlvbi1pbmZvJyk7XG5cdFx0YXJjaGl2ZUluZm9EaXYuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnQXJjaGl2ZSBEZXRhaWxzJyB9KTtcblxuXHRcdGFyY2hpdmVJbmZvRGl2LmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiBgQ29uZmlndXJhdGlvbjogJHt0aGlzLmNvbmZpZy5uYW1lfWAgfSk7XG5cdFx0YXJjaGl2ZUluZm9EaXYuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IGBBcmNoaXZlIG1vZGU6ICR7dGhpcy5jb25maWcuYXJjaGl2ZU1vZGV9YCB9KTtcblx0XHRhcmNoaXZlSW5mb0Rpdi5jcmVhdGVFbCgncCcsIHtcblx0XHRcdHRleHQ6IGBEZXN0aW5hdGlvbjogJHt0aGlzLmRlc3RpbmF0aW9uUGF0aH1gLFxuXHRcdFx0Y2xzOiAnYXJjaGl2ZS1kZXN0aW5hdGlvbi1wYXRoJ1xuXHRcdH0pO1xuXG5cdFx0Ly8gTGluayB1cGRhdGVzIGluZm9ybWF0aW9uXG5cdFx0aWYgKHRoaXMubGlua1VwZGF0ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0Y29uc3QgbGlua0luZm9EaXYgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdhcmNoaXZlLWxpbmstaW5mbycpO1xuXHRcdFx0bGlua0luZm9EaXYuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnTGluayBVcGRhdGVzJyB9KTtcblxuXHRcdFx0Y29uc3QgdG90YWxMaW5rcyA9IHRoaXMubGlua1VwZGF0ZXMucmVkdWNlKChzdW0sIHVwZGF0ZSkgPT4gc3VtICsgdXBkYXRlLmxpbmtDb3VudCwgMCk7XG5cdFx0XHRsaW5rSW5mb0Rpdi5jcmVhdGVFbCgncCcsIHtcblx0XHRcdFx0dGV4dDogYCR7dGhpcy5saW5rVXBkYXRlcy5sZW5ndGh9IGZpbGVzIHdpdGggJHt0b3RhbExpbmtzfSBsaW5rcyB3aWxsIGJlIHVwZGF0ZWRgXG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gU2hvdyBmaWxlcyB0aGF0IHdpbGwgYmUgdXBkYXRlZCAobGltaXQgdG8gZmlyc3QgNSlcblx0XHRcdGNvbnN0IGZpbGVMaXN0ID0gbGlua0luZm9EaXYuY3JlYXRlRWwoJ3VsJywgeyBjbHM6ICdhcmNoaXZlLWxpbmstZmlsZXMnIH0pO1xuXHRcdFx0Y29uc3QgZmlsZXNUb1Nob3cgPSB0aGlzLmxpbmtVcGRhdGVzLnNsaWNlKDAsIDUpO1xuXG5cdFx0XHRmaWxlc1RvU2hvdy5mb3JFYWNoKHVwZGF0ZSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxpc3RJdGVtID0gZmlsZUxpc3QuY3JlYXRlRWwoJ2xpJyk7XG5cdFx0XHRcdGxpc3RJdGVtLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiB1cGRhdGUuZmlsZS5uYW1lLCBjbHM6ICdmaWxlLW5hbWUnIH0pO1xuXHRcdFx0XHRsaXN0SXRlbS5jcmVhdGVFbCgnc3BhbicsIHtcblx0XHRcdFx0XHR0ZXh0OiBgICgke3VwZGF0ZS5saW5rQ291bnR9IGxpbmtzKWAsXG5cdFx0XHRcdFx0Y2xzOiAnbGluay1jb3VudCdcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKHRoaXMubGlua1VwZGF0ZXMubGVuZ3RoID4gNSkge1xuXHRcdFx0XHRmaWxlTGlzdC5jcmVhdGVFbCgnbGknLCB7XG5cdFx0XHRcdFx0dGV4dDogYC4uLiBhbmQgJHt0aGlzLmxpbmtVcGRhdGVzLmxlbmd0aCAtIDV9IG1vcmUgZmlsZXNgLFxuXHRcdFx0XHRcdGNsczogJ21vcmUtZmlsZXMnXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBub0xpbmtzRGl2ID0gY29udGVudEVsLmNyZWF0ZURpdignYXJjaGl2ZS1uby1saW5rcycpO1xuXHRcdFx0bm9MaW5rc0Rpdi5jcmVhdGVFbCgncCcsIHtcblx0XHRcdFx0dGV4dDogJ05vIGxpbmtzIHRvIHRoaXMgZmlsZSB3ZXJlIGZvdW5kLicsXG5cdFx0XHRcdGNsczogJ25vLWxpbmtzLW1lc3NhZ2UnXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvLyBXYXJuaW5nIGlmIGRlc3RpbmF0aW9uIGV4aXN0c1xuXHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLmRlc3RpbmF0aW9uUGF0aCk7XG5cdFx0aWYgKGV4aXN0aW5nRmlsZSkge1xuXHRcdFx0Y29uc3Qgd2FybmluZ0RpdiA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ2FyY2hpdmUtd2FybmluZycpO1xuXHRcdFx0d2FybmluZ0Rpdi5jcmVhdGVFbCgncCcsIHtcblx0XHRcdFx0dGV4dDogJ1x1MjZBMFx1RkUwRiBBIGZpbGUgb3IgZm9sZGVyIGFscmVhZHkgZXhpc3RzIGF0IHRoZSBkZXN0aW5hdGlvbiBwYXRoLiBJdCB3aWxsIGJlIG92ZXJ3cml0dGVuLicsXG5cdFx0XHRcdGNsczogJ3dhcm5pbmctbWVzc2FnZSdcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIEJ1dHRvbnNcblx0XHRjb25zdCBidXR0b25EaXYgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdhcmNoaXZlLWJ1dHRvbnMnKTtcblx0XHRidXR0b25EaXYuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0NhbmNlbCcgfSlcblx0XHRcdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdFx0dGhpcy5vbkNhbmNlbCgpO1xuXHRcdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0XHR9KTtcblxuXHRcdGNvbnN0IGNvbmZpcm1CdXR0b24gPSBidXR0b25EaXYuY3JlYXRlRWwoJ2J1dHRvbicsIHtcblx0XHRcdHRleHQ6ICdBcmNoaXZlJyxcblx0XHRcdGNsczogJ21vZC1jdGEnXG5cdFx0fSk7XG5cdFx0Y29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcblx0XHRcdGNvbmZpcm1CdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXHRcdFx0Y29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9ICdBcmNoaXZpbmcuLi4nO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLm9uQ29uZmlybSgpO1xuXHRcdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25maXJtQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHRcdGNvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSAnQXJjaGl2ZSc7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0FyY2hpdmUgb3BlcmF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQTBEOzs7QUNrQm5ELElBQU0sbUJBQXdDO0FBQUEsRUFDcEQsZ0JBQWdCO0FBQUEsSUFDZjtBQUFBLE1BQ0MsSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVTtBQUFBLE1BQ1YsYUFBYTtBQUFBLE1BQ2IsYUFBYTtBQUFBLElBQ2Q7QUFBQSxFQUNEO0FBQUEsRUFDQSxrQkFBa0I7QUFBQSxFQUNsQixnQkFBZ0I7QUFDakI7OztB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O0FBQUEsUUFDRCxFQUFFLEtBQUs7QUFBQSxNQUNSLE9BQU87QUFDTixjQUFNLEtBQUssZUFBZSxNQUFNLFFBQVEsaUJBQWlCLFdBQVc7QUFBQSxNQUNyRTtBQUFBLElBRUQsU0FBUyxPQUFQO0FBQ0QsY0FBUSxNQUFNLDZCQUE2QixLQUFLO0FBQ2hELFVBQUksd0JBQU8sbUJBQW1CLE1BQU0sU0FBUztBQUFBLElBQzlDO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBYyxlQUNiLE1BQ0EsUUFDQSxpQkFDQSxhQUNDO0FBQ0QsUUFBSTtBQUVILFlBQU0sS0FBSyxTQUFTLFlBQVksTUFBTSxNQUFNO0FBRzVDLFVBQUksS0FBSyxTQUFTLG1CQUFtQixZQUFZLFlBQVksU0FBUyxHQUFHO0FBQ3hFLGNBQU0sU0FBUyxNQUFNLEtBQUssWUFBWSxpQkFBaUIsV0FBVztBQUVsRSxZQUFJLE9BQU8sT0FBTyxTQUFTLEdBQUc7QUFDN0IsY0FBSSx3QkFBTywwQkFBMEIsT0FBTyxtQ0FBbUMsT0FBTyxPQUFPLGVBQWU7QUFBQSxRQUM3RyxPQUFPO0FBQ04sY0FBSSx3QkFBTyx1Q0FBdUMsT0FBTywyQkFBMkI7QUFBQSxRQUNyRjtBQUFBLE1BQ0QsV0FBVyxLQUFLLFNBQVMsbUJBQW1CLFNBQVMsWUFBWSxTQUFTLEdBQUc7QUFFNUUsWUFBSSx3QkFBTyxrQkFBa0IsWUFBWSw2RkFBNkY7QUFBQSxNQUN2SSxPQUFPO0FBQ04sWUFBSSx3QkFBTyw0QkFBNEI7QUFBQSxNQUN4QztBQUFBLElBRUQsU0FBUyxPQUFQO0FBQ0QsY0FBUSxNQUFNLDZCQUE2QixLQUFLO0FBQ2hELFVBQUksd0JBQU8sbUJBQW1CLE1BQU0sU0FBUztBQUFBLElBQzlDO0FBQUEsRUFDRDtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
